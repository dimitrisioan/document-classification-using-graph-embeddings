LGA
NCRYPT
SOURCE
I
GOT
A
NUMBER
OF
REQUESTS
FOR
CODE
SO
HERE
IT
IS
ITS
WRITTEN
IN
ASM
BORLAND
TASM
WILL
DO
TASM
LGAASM
TLINK
T
LGAASM
THE
CODE
LGA
NCRYPTION
C
BY
NICK
NASSUPHIS
CODE
SEGMENT
ASSUME
CSCODE
DSCODE
ORG
START
JMP
BEGIN
GAS
PARTICLE
ASSIGMENT
BIT
PARTICLE
MOVING
EAST
BIT
PARTICLE
MOVING
WEST
BIT
PARTICLE
MOVING
NORTH
BIT
PARTICLE
MOVING
SOUTH
BIT
PARTICLE
MOVING
EAST
BIT
PARTICLE
MOVING
WEST
BIT
PARTICLE
MOVING
NORTH
BIT
PARTICLE
MOVING
SOUTH
COLLISIONG
RULES
GAS
RULES
IF
E
W
AND
N
S
THEN
EWNS
IF
N
S
AND
E
W
THEN
NSEW
FOR
NIBBLES
AND
FOR
BYTES
REFLECTION
RULES
JUST
SWAP
BITS
ALONG
DIRECTIONS
THIS
LOOKUP
TABLE
IMPLEMENTS
TWO
PARTICLE
COLLISIONS
FOR
THE
HPP
LATTICE
GAS
HPPRULE
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
THIS
RULE
IMPLEMENTS
THE
VELOCITYREVERSAL
NEEDED
TO
RUN
THE
GAS
EVOLUTION
IN
REVERSE
ITS
CALLED
A
WALLRULE
BECAUSE
ITS
THE
SAME
AS
IS
ALL
PARTICLES
HIT
A
WALL
HEAD
ON
WALLRULE
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
DB
MAXBYTE
EQU
LINENO
EQU
SRCPTR
DW
OFFSET
DESPTR
DW
OFFSET
SAVEBUFF
DB
DB
DB
DB
DB
DATA
DB
DB
DB
DB
THIS
IS
A
TEST
FOR
A
LATTICE
GAS
BASED
ENCRYPTION
DB
ALGORITHM
THE
DATA
IS
ENCODED
AS
PARTICLES
OF
A
DB
DIGITAL
GAS
WHOSE
TIME
EVOLUTION
IS
THEN
SIMULATED
DB
WITH
A
CELLULARAUTOMATON
TYPE
ALGORITHM
DECRYPTION
DB
CAN
BE
ACHIEVED
BY
RUNNING
THE
SIMULATION
IN
REVERSE
DB
A
THERMODYNAMIC
ARGUMENT
ENSURES
THAT
EVEN
IF
A
SINGLE
DB
BIT
IS
FLIPPED
NO
DECRYPTION
OF
THE
DATA
IS
POSSIBLE
DB
DB
AFTER
THE
GAS
IS
LET
TO
EVOLVE
FOR
TIMESTEPS
DB
ONE
CAN
EITHER
RUN
THE
REVERSE
EVOLUTION
BY
PRESSING
DB
SPACE
OR
FLIP
A
BIT
AND
THEN
RUN
BY
PRESSING
DB
DB
FOR
A
CRYPTOGRAPHIC
APPLICATION
THE
KEY
WOULD
CONSIST
DB
OF
THE
NUMBER
OF
TIME
STEPS
AND
THE
TIME
AND
LOCATION
DB
OF
SPECIFIC
BIT
INVERSIONS
DB
DB
DB
DB
DB
FILL
THE
GAS
WITH
A
PIECE
OF
CODE
INITGAS
MOV
DICSSRCPTR
MOV
SIOFFSET
DATA
MOV
CXLINENO
PUSH
DI
PUSH
CX
MOV
CXMAXBYTE
MOV
ALCSSI
MOV
CSDIAL
INC
SI
INC
DI
LOOP
POP
CX
POP
DI
ADD
DIMAXBYTE
LOOP
MOV
SICSSRCPTR
MOV
DIOFFSET
INITGAS
MOV
MOV
MOV
BYTE
PTR
CSSIAL
NOT
AL
INC
SI
LOOP
RET
DISPLAY
GAS
MOLECULES
BOUNCING
AROUND
SHOWGAS
PUSH
ES
PUSH
SI
PUSH
DI
PUSH
CX
PUSH
BX
MOV
MOV
ESAX
MOV
SICSSRCPTR
MOV
MOV
ADD
PUSH
CX
PUSH
DI
MOV
CXMAXBYTE
MOV
ALCSSI
MOV
BYTE
PTR
ESDIAL
INC
SI
ADD
DEC
CX
JNZ
POP
DI
POP
CX
ADD
LOOP
POP
BX
POP
CX
POP
DI
POP
SI
POP
ES
RET
CSSI
SOURSE
OF
DATA
CSDI
DESTINATION
OF
DATA
SCANONEMIDDLELINE
FIRST
BYTE
IS
A
SPECIAL
CASE
BECAUSE
OF
WARPAROUND
MOV
AL
IS
THE
ASSEMBLED
BYTE
MOV
BHCSSIMAXBYTE
NORTH
IS
ONE
LINE
UP
LOWER
AND
AND
AT
BITS
AND
OR
BLBH
OR
THEM
INTO
THE
ASSEMBLED
BYTE
MOV
BHCSSIMAXBYTE
SOUTH
IS
ONE
LINE
DOWN
HIGHER
AND
AND
AT
BITS
AND
OR
BLBH
PLACE
THE
STUFF
INTO
AL
MOV
WEST
IS
ONE
BYTE
LEFT
LOWER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
EAST
IS
ONE
BYTE
RIGHT
HIGHER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
MOV
ALBYTE
PTR
CSBX
OFFSET
HPPRULE
MOV
CSDIAL
INC
SI
INC
DI
MIDDLE
BYTES
CAN
BE
HANDLED
IN
A
LOOP
MOV
MOV
AL
IS
THE
ASSEMBLED
BYTE
MOV
BHCSSIMAXBYTE
NORTH
IS
ONE
LINE
UP
LOWER
AND
AND
AT
BITS
AND
OR
BLBH
OR
THEM
INTO
THE
ASSEMBLED
BYTE
MOV
BHCSSIMAXBYTE
SOUTH
IS
ONE
LINE
DOWN
HIGHER
AND
AND
AT
BITS
AND
OR
BLBH
PLACE
THE
STUFF
INTO
AL
MOV
WEST
IS
ONE
BYTE
LEFT
LOWER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
EAST
IS
ONE
BYTE
RIGHT
HIGHER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
MOV
ALBYTE
PTR
CSBX
OFFSET
HPPRULE
MOV
CSDIAL
INC
SI
INC
DI
LOOP
LAST
BYTE
IS
ALSO
SPECIAL
MOV
AL
IS
THE
ASSEMBLED
BYTE
MOV
BHCSSIMAXBYTE
NORTH
IS
ONE
LINE
UP
LOWER
AND
AND
AT
BITS
AND
OR
BLBH
OR
THEM
INTO
THE
ASSEMBLED
BYTE
MOV
BHCSSIMAXBYTE
SOUTH
IS
ONE
LINE
DOWN
HIGHER
AND
AND
AT
BITS
AND
OR
BLBH
PLACE
THE
STUFF
INTO
AL
MOV
WEST
IS
ONE
BYTE
LEFT
LOWER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
EAST
IS
ONE
BYTE
RIGHT
HIGHER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
MOV
ALBYTE
PTR
CSBX
OFFSET
HPPRULE
MOV
CSDIAL
INC
SI
INC
DI
RET
CSSI
SOURSE
OF
DATA
CSDI
DESTINATION
OF
DATA
SCANFIRSTLINE
FIRST
BYTE
IS
A
SPECIAL
CASE
BECAUSE
OF
WARPAROUND
MOV
MOV
AND
AND
AT
BITS
AND
OR
BLBH
OR
THEM
INTO
THE
ASSEMBLED
BYTE
MOV
BHCSSIMAXBYTE
AND
AND
AT
BITS
AND
OR
BLBH
PLACE
THE
STUFF
INTO
AL
MOV
WEST
IS
ONE
BYTE
LEFT
LOWER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
EAST
IS
ONE
BYTE
RIGHT
HIGHER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
MOV
ALBYTE
PTR
CSBX
OFFSET
HPPRULE
MOV
CSDIAL
INC
SI
INC
DI
MIDDLE
BYTES
CAN
BE
HANDLED
IN
A
LOOP
MOV
MOV
AL
IS
THE
ASSEMBLED
BYTE
MOV
AND
AND
AT
BITS
AND
OR
BLBH
OR
THEM
INTO
THE
ASSEMBLED
BYTE
MOV
BHCSSIMAXBYTE
AND
AND
AT
BITS
AND
OR
BLBH
PLACE
THE
STUFF
INTO
AL
MOV
WEST
IS
ONE
BYTE
LEFT
LOWER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
EAST
IS
ONE
BYTE
RIGHT
HIGHER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
MOV
ALBYTE
PTR
CSBX
OFFSET
HPPRULE
MOV
CSDIAL
INC
SI
INC
DI
LOOP
LAST
BYTE
IS
ALSO
SPECIAL
MOV
AL
IS
THE
ASSEMBLED
BYTE
MOV
AND
AND
AT
BITS
AND
OR
BLBH
OR
THEM
INTO
THE
ASSEMBLED
BYTE
MOV
BHCSSIMAXBYTE
AND
AND
AT
BITS
AND
OR
BLBH
PLACE
THE
STUFF
INTO
AL
MOV
WEST
IS
ONE
BYTE
LEFT
LOWER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
EAST
IS
ONE
BYTE
RIGHT
HIGHER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
MOV
ALBYTE
PTR
CSBX
OFFSET
HPPRULE
MOV
CSDIAL
RET
CSSI
SOURSE
OF
DATA
CSDI
DESTINATION
OF
DATA
SCANLASTLINE
FIRST
BYTE
IS
A
SPECIAL
CASE
BECAUSE
OF
WARPAROUND
MOV
AL
IS
THE
ASSEMBLED
BYTE
MOV
BHCSSIMAXBYTE
AND
AND
AT
BITS
AND
OR
BLBH
OR
THEM
INTO
THE
ASSEMBLED
BYTE
MOV
AND
AND
AT
BITS
AND
OR
BLBH
PLACE
THE
STUFF
INTO
AL
MOV
WEST
IS
ONE
BYTE
LEFT
LOWER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
EAST
IS
ONE
BYTE
RIGHT
HIGHER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
MOV
ALBYTE
PTR
CSBX
OFFSET
HPPRULE
MOV
CSDIAL
INC
SI
INC
DI
MIDDLE
BYTES
CAN
BE
HANDLED
IN
A
LOOP
MOV
MOV
AL
IS
THE
ASSEMBLED
BYTE
MOV
BHCSSIMAXBYTE
AND
AND
AT
BITS
AND
OR
BLBH
OR
THEM
INTO
THE
ASSEMBLED
BYTE
MOV
AND
AND
AT
BITS
AND
OR
BLBH
PLACE
THE
STUFF
INTO
AL
MOV
WEST
IS
ONE
BYTE
LEFT
LOWER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
EAST
IS
ONE
BYTE
RIGHT
HIGHER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
MOV
ALBYTE
PTR
CSBX
OFFSET
HPPRULE
MOV
CSDIAL
INC
SI
INC
DI
LOOP
LAST
BYTE
IS
ALSO
SPECIAL
MOV
AL
IS
THE
ASSEMBLED
BYTE
MOV
BHCSSIMAXBYTE
AND
AND
AT
BITS
AND
OR
BLBH
OR
THEM
INTO
THE
ASSEMBLED
BYTE
MOV
AND
AND
AT
BITS
AND
OR
BLBH
PLACE
THE
STUFF
INTO
AL
MOV
WEST
IS
ONE
BYTE
LEFT
LOWER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
EAST
IS
ONE
BYTE
RIGHT
HIGHER
AND
AND
AT
BITS
AND
OR
BLBH
MOV
MOV
ALBYTE
PTR
CSBX
OFFSET
HPPRULE
MOV
CSDIAL
INC
SI
INC
DI
RET
INVERT
ALL
VELOCITIES
IN
THE
GAS
INVERTALL
PUSH
BX
PUSH
CX
PUSH
SI
MOV
SICSSRCPTR
MOV
MOV
CXLINENO
PUSH
CX
MOV
CXMAXBYTE
MOV
BLCSSI
MOV
ALBYTE
PTR
CSBX
OFFSET
WALLRULE
MOV
CSSIAL
INC
SI
LOOP
POP
CX
LOOP
POP
SI
POP
CX
POP
BX
RET
ITERATEONCE
MOV
SICSSRCPTR
MOV
DICSDESPTR
MOV
CSSRCPTRDI
MOV
CSDESPTRSI
PUSH
SI
PUSH
DI
CALL
SCANFIRSTLINE
POP
DI
POP
SI
ADD
SIMAXBYTE
ADD
DIMAXBYTE
MOV
DONT
SCAN
FIRST
AND
LAST
PUSH
SI
PUSH
DI
PUSH
CX
CALL
SCANONEMIDDLELINE
POP
CX
POP
DI
POP
SI
ADD
SIMAXBYTE
ADD
DIMAXBYTE
LOOP
PUSH
SI
PUSH
DI
CALL
SCANLASTLINE
POP
SI
POP
DI
RET
ITERATE
HPP
RULE
CX
TIMES
ITERATE
PUSH
CX
CALL
ITERATEONCE
POP
CX
CALL
SHOWGAS
LOOP
ITERATE
RET
ITERATE
HPP
RULE
CX
TIMES
ITERATEUNTIL
MOV
MOV
CXOFFSET
OFFSET
MOV
ALBYTE
PTR
CSSI
OFFSET
XOR
BYTE
PTR
CSSI
OFFSET
INC
SI
LOOP
CALL
ITERATEONCE
CALL
SHOWGAS
MOV
SICSSRCPTR
MOV
MOV
MOV
MOV
MOV
BLBYTE
PTR
CSSI
MOV
DLBYTE
PTR
CSBXWALLRULE
NOT
AH
XOR
DLAH
AND
ALDL
INC
SI
LOOP
MOV
MOV
CXOFFSET
OFFSET
MOV
AHBYTE
PTR
CSSIOFFSET
AND
AHAL
XOR
BYTE
PTR
CSSIOFFSET
INC
SI
LOOP
JMP
MOV
AXOFFSET
PUSH
AX
RET
DB
PUSH
AX
PUSH
BX
PUSH
CX
PUSH
DX
PUSH
DS
MOV
MOV
DXCSMSGPTR
INT
POP
DS
POP
DX
POP
CX
POP
BX
POP
AX
RET
DB
MSGPTR
DW
OFFSET
MSG
MSG
DB
THIS
MESSAGE
IS
PRINTED
OUT
DB
CODE
DECRYPTED
USING
DATA
FROM
THE
DB
WHICH
WAS
APPLIED
TO
THE
DECODING
DB
AFTER
EVERY
TIME
DB
THE
DECODING
FUNCTION
LEFT
THE
CODE
DB
EXCEPT
AFTER
THE
GAS
EVOLUTION
HAD
DB
REVERSED
THE
TIMES
EQU
REPETITIONS
ARE
ENOUGH
TO
EQUILIBRATE
THE
GAS
BEGIN
MOV
MOV
MOV
MOV
MOV
INT
MOV
MOV
MOV
MOV
INT
CALL
INITGAS
CALL
SHOWGAS
MOV
INT
PUSH
CX
MOV
CXTIMES
CALL
ITERATE
CALL
INVERTALL
CALL
SHOWGAS
MOV
INT
CMP
JNE
MOV
SICSSRCPTR
XOR
BYTE
PTR
MOV
CXTIMES
CALL
ITERATEUNTIL
CALL
INVERTALL
CALL
SHOWGAS
MOV
INT
CODE
ENDS
END
START
